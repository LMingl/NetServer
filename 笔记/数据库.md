### MySql
DB 数据库（datebase）
DBMS 数据库管理系统 比如mysql
SQL  结构化查询语言
#### SQL概述
sql全称结构化查询语言，sql语言不需要用户了解具体的数据存放方式
sql就是用来和数据库打交道的，用sql语言完成和数据库的通信，sql也是一套标准，但是每个数据库都有自己的特性
这是就不是一套标准了，（90%sql语句都是通用的）
##### SQL分类
DDL DML DCL 三种


**DQL语句 数据查询语言**
基础查询
条件查询
排序查询
常见函数
分组函数
分组查询
连接查询
子查询
分页查询
union 联合查询
**DML语句 数据操作语言**
插入语句
修改语句
删除语句
**DDL语句 语句库定义语言**
库和表的管理
常见数据类型介绍
常见约束
**TCL语句 事务控制语言**
事务和事务处理
#### DBMS为完成DB管理运行的程序
语言编译器
查询优化与查询实现
数据存取与索引
通信控制
事务管理
故障恢复
安全性控制
数据字典管理
#### DBMS管理数据的三个层次
Userlevel   logical level physical level
三级模式（三级视图）
两层映像：E-C Mapping   C-I Mapping
两个独立性：逻辑数据独立性    物理数据独立性
#### 模式与 模式的结构：数据模型
数据模型：
规定模式guanxi统一描述方式的模型，包括：数据结构、操作、约束
guan'xi是对模式本身结构的抽象
比如关系模型，所有模式都可为抽象表的形式（数据结构）

三大经典数据模型：
关系模型
层次模型

### 关系模型
一个关系就是一个表
关系模型就是处理Table的，它由三部分构成
>1.描述DB各种数据的基本结构形式(relation)
>2.描述table和table之间可能发生的各种操作（关系运算）
关系代数(基于集合的运算)和关系演算（元组演算(基于逻辑的运算)和域演算(基于示例的运算)）
>3.描述这些操作所应遵顼的约束条件（完整性描述）
实体完整性、参照完整性、用户自定义完整性
#### 关系
列的取值范围-域
**域**：一组值的集合，具有相同的数据类型
**元组**，可能组合成的元组：笛卡尔积
一组域的笛卡尔积，为n元组，元组每一个值叫做一个分量
**关系**：一组域的笛卡尔积的子集
**笛卡尔积中具有某一方面意义的哪些元组被称为一个关系（relation）**
需要为每一列起一个名字，该名字为**属性名**
**关系模型**:关系可用R(A1:D1,A2:D2,-------An:Dn)表示
关系模式与关系：同一个关系模式下，可有很多关系，关系模式是关系的结构

关系的特性：
列是同质的：即每一列中的分量来自同一个域，是同一类型的数据
列位置的互换性和行位置的互换性
关系是以内容（名字或值）来区分，而不是属性在关系的位置来区分
关系和表table的差别：table可以有重复的元组
属性不可再分特性：又称为**关系第一范式**

**候选码（候选键）与主码（主键）**：
关系中的一个属性组，其值能唯一标识一个元组
有时，关系中有很多组候选码。
当有多个候选码时，选定一个作为主码
BDMS以主码为主要线索管理关系中的各个元组
**主属性与非主属性**：包含在任何一个候选码中的属性被称为主属性，其他属性为非主属性

**外码/外键**：
关系R中的一个属性组，它不是R的候选码，但它与另一个关系S的候选码相对应，则称这个属性组为R的外码或外键
两个关系通常是通过外码连接起来的
#### 关系模型的完整性
实体完整性：关系的主码中的属性值不能为空值
参照完整性：如果关系R1的外码与关系R2的主码相对应，则R1中的每一个元组的外码或者等于R2主码值或者为空值
用户自定义完整性：用户针对具体的应用环境定义的完整性约束条件
DBMS对关系完整性的支持
#### 关系模型之关系代数
**基本操作：**
R和S满足并相容性：m=n并且domain(A)=domain(B)
并操作
差操作
广义积操作
选择操作
投影操作
**扩展操作：**
交操作
theta连接操作：涉及多个表的操作
等值连接
自然连接
除操作
外连接操作:解决失配问题
  外连接=自然连接（theta连接）+失配的元组（与全空元组形成的连接）
  外连接的形式有：左外连接、右外连接、全外连接
#### 关系模型之关系演算
关系演算是以数理逻辑中的谓词演算为基础的
SQL语言是继承了关系代数和关系演算的优点形成的
按照谓词变量的不同，可分为**关系元组演算**和**关系域演算**
元组演算：与 或 非 存在 全称
元组演算的等价变换
域演算公式：
域变量的组合
#### 关系运算的安全性
不产生无限关系和无穷验证的运算被称为是安全的
关系代数是一种集合运算，是安全的
关系演算不一定是安全的，因此需要对关系演算施加约束条件，即任何一个公式都是在一个集合范围内操作。

### SQL语言
**交互式SQL->嵌入式SQL->动态SQL**
#### 利用sql语言建立数据库
创建数据库:定义数据库和表（DDL），向表中追加元组（DML）
创建database和table 
      create alter 
      primary key:主键约束，每个表只能创建一个主键约束
      unique:唯一性约束（候选键），可以有多个
      not null：非空约束
      sql92数据类型：char varchar int numeric real time
追加元组：DML
      insert  update  delete  select 

sql语言之视图
      三层模式两层映像：对应概念模式的数据在sql中被称为基本表，
      而对应于外模式的数据称为视图（VIEW）.视图不仅包含外模式，而且
      包含其EC映像。
      视图在sql中只存储由基本表导出视图所需要的公式，即由基本表导出视图的
      映像信息，其数据并不存储，而是在运行过程中动态产生于维护的。
      对视图数据的修改要反映在对基本表的修改上

      视图需要先定义，再使用
      sql视图的查询：对视图的查询最终还是要反映到对基本表的
      的查询
      sql视图的更新：是比较复杂的，因视图不保存数据， 有时视图定义的映射是不可逆的
      sql视图更新的可执行性：
      视图的select目标列包括聚集函数，则不可更新
      -------
      -------
      撤销视图：drop
#### sql语言与数据库完整性和安全性
数据库完整性是值DBMS应保证的一种特性
广义完整性：语义完整性、并发控制、安全控制、DB故障恢复
侠义完整性：
数据库完整性管理的作用：
防止和避免数据库中不合理数据的出现
如何保证：
DBMS允许用户定义一些完整性约束规则（sql-ddl）
完整性约束条件：
intergrity constraint :: = (O,P,A,R)
数据集合、谓词条件、触发条件、响应动作
##### 分类
按约束对象分类：
域完整性约束条件  施加到某一列上
关系完整性约束条件   施加到table上
按约束来源分类：
结构约束  来自于模型的约束如主键约束
内容约束  来自用户的约束
按约束状态分类：
静态约束
      列完整性-域完整性约束
      表完整性-关系完整性约束
动态约束
      触发器
create table 有三种功能：定义关系模式，定义完整性约束，和定义物理存储特性
**断言**assertion
一个断言就是一个谓词表达式，表达了数据库总能满足的条件
表约束和列约束就是一些特殊的断言
断言测试会增加数据库的负担，断言使用比较少
**触发器trigger**是一种过程完整性约束，是一段程序，该程序可以在
特定的时刻被自动触发执行。
##### 安全性
自主安全性机制：存取控制
      通过权限在用户之间的传递，使用户自主管理数据库安全
强制安全性机制：
      通过对数据和用户强制分类
推断控制机制：
      防止通过历史信息，推断出不该被知道的信息
数据加密存储机制：
      通过加密、解密
####### 自主安全性机制
通常情况下，自主安全性是通过授权机制来实现的。
用户在使用数据库前必须由DBA处获得一个账户，并由DBA授予该账户一定的权限

数据库自主安全性访问规则：
DBMS将权力和用户结合在一起，形成了一个访问控制表，依据该规则表
可以实现对数据库的安全性控制
AccessRule::=(S,O,t,P)
请求主体   访问对象  访问权力 谓词（拥有权力需满足的条件）
AccessRule通常放在数据字典或系统目录中，构成所有用户对DB的访问权力
两种控制方法：
按名控制安全性
**存储矩阵**
按内容控制安全性
**视图**是安全性控制的重要手段
####### 语言的用户与权力
授权机制-自主安全性；视图的运用
关系级别<- 账户级别(程序员) <- 超级用户
级别1 select 读
级别2 modify 更细
级别3 create 创建
授权命令：
grant 
on [table]
to 
[with grant option]
收回授权命令：
revoke 
on
from
####### 强制安全性机制
##### 嵌入式sql语言之基本技巧
高级语言+sql语言
嵌入式sql语言：
将sql语言嵌入到莫一种高级语言使用
这种高级语言又称宿主语言
嵌入式sql与前面的交互式sql有不同的操作






























