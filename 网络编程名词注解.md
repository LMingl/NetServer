### socket编程底层原理
![](images/TCPIP.jpg)
其中传输层就是TCP所在的地方，socket在这里就是起到连接应用层与传输层的作用
socket的诞生就是为了应用程序能够更方便的将数据经由传输层来传输，所以它本质上是对TCP/IP的运用进行了一层封装，然后应用程序直接调用socket API即可进行通信，分为两部分。
![三次握手](images\三次握手.jpg)
该图展示的就是建立TCP/IP连接的过程，经典叫法为“三次握手”
![](images\数据传输.jpg)
传输的过程涉及数据Copy。其中的发送缓冲区和接收缓冲区就是套接字缓冲
![](images\四次挥手.jpg)
连接用完后需要关闭。这就是经典的“四次握手”

### 名词注解-以字母表顺序

#### A
accept() :在addr中填写客户端的套接字地址，并返回一个已连接描述符

#### B
bind():函数 :告诉内核将服务器套接字地址和套接字描述符联系起来 
#### C
connect(int sockfd, struct sockaddr *serv_addr, int addrlen):试图与套接字地址为serv_addr的服务器建立因特网连接
#### D
#### E
errno:全局变量 存放错误消息
#### F
#### G
#### H
#### I
INADDR_ANY : 通配符地址 告诉内核这个服务器将接收到这台主机的任何IP地址
#### J
#### K
#### L
#### M
memset():函数
#### N
Network Byte order & Host Byte order : 网络字节顺序(从高到低顺序存储)和主机字节顺序(与CPU设计有关)
#### O
#### P
perror():打印错误信息
POSIX 标准 :保证在源码一级在多种操作系统上移植运行
process :进程  fork() vfork()
#### Q
#### R
#### S
socket():API
socket : 套接字 由IP和端口(标识应用进程)组成 包括流套接字和数据报套接字
socket返回的clientfd描述符仅是部分打开，还不能用于读写
system calls : 系统调用 ->进程控制、进程通信、文件系统控制、系统控制、内存管理、网络管理、socket控制、用户管理
#### T
#### U
#### V
#### W
#### X
#### Y
#### Z

### 协议
#### HTTP协议
HTTP由两个程序实现：一个客户程序和一个服务器程序。客户程序和服务器程序运行在不同的端系统中，通过交换HTTP报文进行会话。HTTP是面向事务的应用层协议，它规定了在浏览器和服务器之间的请求和响应的格式与规则。
HTTP使用TCP作为它的支撑运输协议。一旦连接建立，该浏览器和服务器进程就可以通过套接字接口访问TCP。客户向它的套接字接口发送HTTP请求报文并从它的套接字接口接收HTTP响应报文
服务器向客户发送被请求的文件，而不存储任何关于该客户的状态信息。因为HTTP服务器并不保存关于客户的任何消息，所以我们说HTTP是一个无状态协议。
1.非持续连接的HTTP
每一个网页元素对象的传输都需要单独建立一个TCP连接，每个TCP连接只传输一个请求报文和一个响应报文
2.持续链接的HTTP
在采用持续连接的情况下，服务器在发送响应后保持该TCP连接打开
#### HTTP报文格式
HTTP报文有两种：请求报文和响应报文
**1.HTTP请求报文**

![](images\请求报文.png)
HTTP 支持许多不同的方法，包括GET、POST、OPTIONS、HEAD、PUT、DELETE 和TRACE
**2.HTTP响应报文**

![](images\响应报文.png)
两个最重要的报头是Content-Type 与 Content-Length

#### Web内容
内容是与一个MIME(多用途的网际邮件扩充协议)类型相关的字节序列：常用的text/html HTML页面
每条由Web服务器返回的内容都是和它管理的某个文件相关联。这些文件的每一个都有唯一的名字，叫做URL。"?"字符分隔文件名和参数，而且每个参数都用"&"字符分隔开。
客户端使用**前缀**来决定与哪类服务器联系
服务器使用**后缀**来发现在它文件系统中的文件，并确定请求的是静态内容还是动态内容
- 确定一个URL指向的是静态内容还是动态内容没有标准的规则。
- 后缀最开始的那个"/"不表示Unix的根目录。相反，它表示的是被请求内容类型的主目录。
- 最小的URL后缀是"/"字符， 所有服务器将其扩展为某个默认的主页，例如/index.html.这解释了为什么简单的在浏览器键入一个域名就可以取出一个网站的主页。浏览器在URL后添加缺失的"/"，并将之传递给服务器，服务器又把"/"扩展到某个默认的文件名。